# Как выложить дашборд, чтобы любой сотрудник мог зайти и посмотреть

**Только твои шаги (кратко):** [ЧТО_СДЕЛАТЬ_ТЕБЕ_ДЛЯ_ОБЛАКА.md](ЧТО_СДЕЛАТЬ_ТЕБЕ_ДЛЯ_ОБЛАКА.md)

Один раз настраиваешь — потом даёшь коллегам одну ссылку. Они открывают её в браузере в любое время, без установки программ и без твоего компьютера.

---

## Шаг 1. Аккаунт на GitHub (если ещё нет)

1. Открой в браузере **https://github.com**.
2. Если нет аккаунта — нажми **Sign up**, зарегистрируйся (можно через почту или Google).
3. Войди в аккаунт.

---

## Шаг 2. Создать репозиторий и залить проект

1. На GitHub нажми **«+»** (вверху справа) → **«New repository»**.
2. **Repository name:** введи, например, **anchor_checker**.
3. Выбери **Private** или **Public** (для Streamlit Cloud подойдёт любой).
4. **Не ставь** галочки «Add a README» и т.д. Нажми **«Create repository»**.
5. На открывшейся странице будет блок **«…or push an existing repository from the command line»**. Скопируй оттуда команды (они будут такие, замени `YOUR_USERNAME` на свой логин GitHub):

   ```bash
   git remote add origin https://github.com/YOUR_USERNAME/anchor_checker.git
   git branch -M main
   git push -u origin main
   ```

6. На своём компьютере открой **PowerShell**, перейди в папку проекта:
   ```text
   cd c:\project\anchor_checker
   ```
7. Если в этой папке ещё не инициализирован Git, выполни по очереди:
   ```text
   git init
   git add .
   git status
   ```
   Убедись, что в списке **нет** файлов `service_account.json` и `service_account.json.json` (они в .gitignore и не должны попасть в коммит). Если они есть в списке — не делай `git add` на них, удали их из индекса.
8. Выполни:
   ```text
   git commit -m "Dashboard for link placements"
   git remote add origin https://github.com/YOUR_USERNAME/anchor_checker.git
   git branch -M main
   git push -u origin main
   ```
   Подставь свой URL репозитория и логин. Если попросит логин/пароль — используй логин GitHub и **Personal Access Token** вместо пароля (в настройках GitHub: Settings → Developer settings → Personal access tokens → создать токен с правом `repo`).

**Важно:** файлы `service_account.json` и `service_account.json.json` не должны попасть в репозиторий. Они уже добавлены в `.gitignore`. Перед `git add` можно проверить: `git status` не должен показывать эти файлы.

---

## Шаг 3. Подключить Streamlit Cloud

1. Открой в браузере **https://share.streamlit.io**.
2. Нажми **«Sign up»** или **«Log in»** и войди через **GitHub** (удобнее — тогда сразу видны твои репозитории).
3. После входа нажми **«New app»**.
4. Заполни:
   - **Repository:** выбери **твой_логин/anchor_checker** (или как назвал репозиторий).
   - **Branch:** **main**.
   - **Main file path:** введи **`app/dashboard/app.py`** (именно так, со слэшами).
5. Нажми **«Deploy»**. Подожди 1–3 минуты. Появится страница приложения — пока без данных (ключ ещё не добавлен).

---

## Шаг 4. Добавить секрет с ключом Google

Чтобы дашборд в облаке мог читать таблицы, нужно передать ему ключ через **Secrets**. Проще всего сгенерировать текст командой:

1. В PowerShell из папки `c:\project\anchor_checker` выполни: **python prepare_streamlit_secret.py**
2. **Скопируй весь вывод** (от `service_account_json` до последней `'''`).
3. На Streamlit Cloud: своё приложение → **Settings** → **Secrets** → вставь скопированное → **Save**.

Через 10–30 секунд обнови страницу дашборда — данные подгрузятся (если таблицы расшарены на email из ключа).

---

## Шаг 5. Ссылка для сотрудников

После успешного деплоя вверху страницы будет ссылка вида:
**`https://anchor-checker-....streamlit.app`**

Эту ссылку можно:
- отправить в чат или почту команде;
- добавить в закладки или внутреннюю инструкцию.

**Любой сотрудник** открывает её в браузере — видит дашборд. Ничего устанавливать не нужно. Твой компьютер может быть выключен — дашборд работает в облаке.

---

## Если что-то пошло не так

- **«No data» на выложенном дашборде** — проверь, что в Secrets вставлен **полный** JSON (начинается с `{`, заканчивается на `}`), что в начале стоит `service_account_json = '''` и в конце `'''`. И что четыре таблицы по-прежнему расшарены на **client_email** из этого JSON с правом «Читатель».
- **Ошибка при деплое** — проверь, что в **Main file path** указано именно **`app/dashboard/app.py`** и что в репозитории нет файлов `service_account.json` / `service_account.json.json` (они не должны быть в Git).
- **Дашборд «засыпает»** — у бесплатного Streamlit Cloud приложение может останавливаться при отсутствии обращений; первое открытие ссылки после паузы может занять 10–30 секунд.

Подробнее про секреты и форматы: [ДАШБОРД_ДЛЯ_ВСЕХ.md](ДАШБОРД_ДЛЯ_ВСЕХ.md).
